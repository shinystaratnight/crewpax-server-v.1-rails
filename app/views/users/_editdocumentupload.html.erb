<div class="panel panel-default">
  <div class="panel-heading" role="tab" id="headingThree">
    <h3 class="panel-title" id="upload_file_title">
      <a role="button" data-toggle="collapse" data-parent="#accordion" href="#collapseFour" aria-expanded="false" aria-controls="collapseThree">Email Documents</a>
    </h3>
  </div>
  <div id="collapseFour" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingThree">
    <div class="alert alert-success alert-dismissible" hidden="true" role="alert" id="success_msg"></div>
    <div class="alert alert-danger alert-dismissible"  role="alert" hidden="true" id="fail_msg"></div>
    <% resume_attachments = @attachments.find_all{|file| file.type ==  "Resume"}%>
    <% noa_attachments = @attachments.find_all{|file| file.type ==  "NOA"}%>
    <% driver_attachments = @attachments.find_all{|file| file.type ==  "Drivers_License"}%>
    <% other_attachments = @attachments.find_all{|file| file.type ==  "other"} %>

    <% if resume_attachments.present? %>  
      <% resume_attachments.map{|resume| %> 
        <div class="existing_file" data-file-type="Resume" data-clickable="">          
          <a data-toggle="collapse" data-parent="#accordion" href="#collapseSix" aria-expanded="false" aria-controls="collapseThree">  
            <label class="file_info" data-file-id="<%=resume.id%>">
              <i class="fa fa-file-pdf-o" style="font-size: 50px; color:black;"></i>
              </br>
              Resume
            </label>
          </a>
          <a href="<%=resume.file_share_link%>" class="share_link"><i class="fa fa-paperclip" style="font-size: 20px; color: gray;"></i></a>          
        </div>
      <% } %>
    <% else %>
      <div class="existing_file" data-file-type="Resume" data-clickable=""> 
        <span hidden="true">
          <a data-toggle="collapse" data-parent="#accordion" href="#collapseSix" aria-expanded="false" aria-controls="collapseThree">  
            <label class="file_info" data-file-id="">
              <i class="fa fa-file-pdf-o" style="font-size: 50px; color:black;"></i>
              </br>
              Resume
            </label>
          </a>
          <a href="" class="share_link"><i class="fa fa-paperclip" style="font-size: 20px; color: gray;"></i></a> 
        </span>  
      </div>     
    <% end %>
    
    <% if noa_attachments.present? %>
      <% noa_attachments.map{|noa| %> 
        <div class="existing_file" data-file-type="NOA" data-clickable="">         
          <a data-toggle="collapse" data-parent="#accordion" href="#collapseSix" aria-expanded="false" aria-controls="collapseThree">   
            <label for="file_pdf" class="file_info" data-file-id="<%=noa.id%>">
              <i class="fa fa-file-pdf-o" id="file_pdf" style="font-size: 50px; color:black;"></i>
              </br> 
              NOA
            </label>
          </a>    
          <a href="<%=noa.file_share_link%>" class="share_link"><i class="fa fa-paperclip" style="font-size: 20px; color: gray; margin-left: -15px;"></i></a>    
        </div>
      <% } %>
    <% else %>
        <div class="existing_file" data-file-type="NOA" data-clickable="">
          <span hidden="true">
            <a data-toggle="collapse" data-parent="#accordion" href="#collapseSix" aria-expanded="false" aria-controls="collapseThree">   
              <label for="file_pdf" class="file_info" data-file-id="">
                <i class="fa fa-file-pdf-o" id="file_pdf" style="font-size: 50px; color:black;"></i>
                </br> 
                NOA
              </label>
            </a>    
            <a href="" class="share_link"><i class="fa fa-paperclip" style="font-size: 20px; color: gray; margin-left: -15px;"></i></a>    
          </span>
        </div>
    <% end %>     

    <% if driver_attachments.present? %> 
      <% driver_attachments.map {|driver| %>          
        <div class="existing_file" data-file-type="Drivers_License" data-clickable=""> 
          <a data-toggle="collapse" data-parent="#accordion" href="#collapseSix" aria-expanded="false" aria-controls="collapseThree">
          <label class="file_info" data-file-id="<%=driver.id%>">
            <i class="fa fa-file-pdf-o" style="font-size: 50px; margin-left: 25px; color:black;"></i>
            </br>
            Driver's License
          </label>
          </a>
          <a href="<%=driver.file_share_link %>" class="share_link"><i class="fa fa-paperclip" style="font-size: 20px; color: gray;"></i></a>     
        </div>
      <% } %>
    <% else %>
      <div class="existing_file" data-file-type="Drivers_License" data-clickable=""> 
        <span hidden="true">
          <a data-toggle="collapse" data-parent="#accordion" href="#collapseSix" aria-expanded="false" aria-controls="collapseThree">
          <label class="file_info" data-file-id="">
            <i class="fa fa-file-pdf-o" style="font-size: 50px; margin-left: 25px; color:black;"></i>
            </br>
            Driver's License
          </label>
          </a>
          <a href="" class="share_link"><i class="fa fa-paperclip" style="font-size: 20px; color: gray;"></i></a> 
        </span>
      </div>
     
    <% end %>


    <% if other_attachments.present? %>  
      <% other_attachments.map {|other| %>     
        <div class="existing_file" data-file-type="other">       
          <a data-toggle="collapse" data-parent="#accordion" href="#collapseSix" aria-expanded="false" aria-controls="collapseThree">  
          <label class="file_info" data-file-id="<%=other.id%>">
            <i class="fa fa-file-pdf-o" style="font-size: 50px;color:black;"></i>
            </br>
            Other
          </label>
          </a>
          <a href="<%=other.file_share_link %>" class="share_link"><i class="fa fa-paperclip" style="font-size: 20px; color: gray;"></i></a>       
        </div>
      <% } %>
    <% else %>
        <div class="existing_file" data-file-type="other"> 
          <span hidden="true">
            <a data-toggle="collapse" data-parent="#accordion" href="#collapseSix" aria-expanded="false" aria-controls="collapseThree">  
            <label class="file_info" data-file-id="">
              <i class="fa fa-file-pdf-o" style="font-size: 50px;color:black;"></i>
              </br>
              Other
            </label>
            </a>
            <a href="" class="share_link"><i class="fa fa-paperclip" style="font-size: 20px; color: gray;"></i></a> 
          </span>  
        </div>
     
    <% end %>
 
    <div id="collapseSix" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingThree">
      <%= render 'emailForm' %>
    </div>

    

    </br>
    <a role="button" class="btn btn-primary" id="upload_new_documents_button" data-toggle="collapse" data-parent="#accordion" href="#collapseFive" aria-expanded="false" aria-controls="collapseThree">Upload new documents</a>
    <div id="collapseFive" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingThree">
      <form id="file_upload_form" class="form-inline" method="post" action="/attachments" nctype="multipart/form-data" data-attachment-id="">

        <div class="form-group" class="file_upload">
          <label for="client_email" class="document_email"> Recipient's email address:</label>
          <input type="text" class="client_email" name="client_email" id="recipient_email"> 
        </div>

        <div class="form-group" class="file_upload">
          <label for="upload_file"  class="document_email"> File: </label> 
          <input id="upload_file" type="file" name="file">
        </div>

        <div class="form-group" class="file_upload">
        <label class="document_email">Type of the attachment: </label>  
          <select id="selected_file">
            <option value="Resume">Resume</option>
            <option value="NOA">NOA</option>
            <option value="Drivers_License">Drivers License</option>
            <option value="other"> Other </option>
          </select>
        </div>          
        <button class="btn btn-primary" id="submit_button"><i class="fa fa-envelope-o"></i> Email</button>
        <span id="uploading" hidden="true">
          <i class="fa fa-spinner fa-spin" style="font-size: 40px; color: gray;"></i>  
        </span>       
        <span id="success_upload" hidden="true">
          <i class="fa fa-check-circle" style="font-size: 40px; color:green"></i>
        </span>         
      </form>       
    </div>
  </div>
</div>