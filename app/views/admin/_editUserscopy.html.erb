<div class="panel panel-default">
  <div class="panel-heading" role="tab" id="">
    <h3 class="panel-title">
      <a role="button" data-toggle="collapse" data-parent="#accordion" href="#editUser" aria-expanded="false" aria-controls="editUser"><span class="caret rotated"></span> Users</a>
    </h3>
  </div>

  <div id="editUser" class="panel panel-collapse collapse" role="tabpanel" aria-labelledby="editUser">

   <div class="list-group">

      <%@users.each do |user| %>
        <div class="list-group-item" id="button<%=user.name.tr(' ','-')%>">
          <a role="button" data-toggle="collapse" data-parent="#accordion" href="#edit<%=user.name.tr(' ','-')%>" aria-expanded="false" aria-controls="edit<%=user.name.tr(' ','-')%>">
            <%= user.name %>
          </a>
        </div>
      <% end %>

    </div>
  </div>

  <%@users.each do |user| %>

    <div id="edit<%=user.name.tr(' ','-')%>" class="panel panel-collapse collapse" role="tabpanel" aria-labelledby="edit<%=user.name.tr(' ','-')%>" data-name="<%=user.name.tr(' ','-')%>" >

      <div class="field">
        <a role="button" data-toggle="collapse" href="#editUserInfo" aria-expanded="true" aria-controls="editUserInfo"><span class="caret"></span> Personal Info</a>
      </div>

      <div id="editUserInfo" class="panel panel-collapse collapse in"  role="tabpanel" aria-labelledby="editUserInfo">

        <div class="field user-info" data-user-id="<%=user.id %>">
          <h5> User Name: </h5>
          <div class="user-name" contenteditable="true"><%=user.name %></div>
          <span class="error" hidden="true" class="user-name-error"> *Name is not valid</span>
        </div>

        <div class="field">
          <h5> Email: </h5>
          <div class="profile_input" data-profile-entry="email" id="email" contenteditable="true"><%=user.email %></div>
          <span class="error" hidden="true" id="email-error"> *Email address is not valid</span>
        </div>

        <div class="field">
            <h5> Phone:</h5>
            <div class="profile_input" data-profile-entry="phone" id="phone" contenteditable="true"><%=user.phone %></div>
            <span class="error" hidden="true" id="phone-error"> *Phone number is not valid</span>
        </div>

        <div class ="field" data-address-id="" id="mailing_address_info">
          <h5> Mailing Address: </h5>
          <div class="profile_input" id="mailing_address" contenteditable="true"><%if user.addresses.find_by(type: "Mailing")%><%=user.addresses.find_by(type: "Mailing").address_input%><% end %></div>
          <span class="error" hidden="true" id="mailing-address-error"> *Mailing address is not valid</span>
        </div>
          
        <div class ="field" data-billing-id="" id="billing_address_info">
          <h5> Billing Address: </h5>
          <div class="profile_input" id="billing_address" contenteditable="true"><%if user.addresses.find_by(type: "Billing")%><%=user.addresses.find_by(type: "Billing").address_input%><% end %></div>
          <span class="error" hidden="true" id="billing-address-error"> *Billing address is not valid</span>
        </div>
          
        <div class ="field" data-shipping-id="" id="shipping_address_info">
          <h5> Shipping Address: </h5>
          <div class="profile_input" id="shipping_address" contenteditable="true"><%if user.addresses.find_by(type: "Shipping")%><%=user.addresses.find_by(type: "Shipping").address_input%><% end %></div>
          <span class="error" hidden="true" id="shipping-address-error"> *Shipping address is not valid</span>
        </div>

        <div class="field">
          <h5> Do you have a traffic control ticket? </h5>           
            <% if user.has_traffic_control_ticket == true %>           
              <input type="checkbox" name="my-checkbox" data-on-text="Yes" 
              data-off-text= "No" data-on-color="success" data-off-color="danger" checked="true" id="traffic_control" data-section="traffic_control"> 
            <% else %>
              <input type="checkbox" name="my-checkbox" data-on-text="Yes" 
              data-off-text= "No" data-on-color="success" data-off-color="danger" 
              id="traffic_control" data-section="traffic_control">  
            <% end %>
        </div>
          
        <div class= "field">
          <h5>Do you have access to a vehicle? </h5> 
            <% if user.has_vehicle %>
              <input type="checkbox" name="my-checkbox" data-on-text="Yes" 
              data-off-text= "No" data-on-color="success" data-off-color="danger" 
              id="vehicle" checked="true" data-section="vehicle">
            <% else %>
              <input type="checkbox" name="my-checkbox" data-on-text="Yes" 
              data-off-text= "No" data-on-color="success" data-off-color="danger" 
              id="vehicle" data-section="vehicle" >
            <% end %>
        </div> 
        
        
        <div class="field">
          <h5>
            Upload Profile Picture
            <div> <%=image_tag(user.image.url(:thumb))%></div>
            <input type="file" id="upload_picture" >
            <input type="hidden" name="image_cache">
            <div id="profile_pic" hidden="true" contenteditable="true">            
            </div>
          </h5>
        </div>
      </div>
    </div>
<!--add roles within unions, uses same js functions as editing profile from user page-->
    <div class="field">
      <a role="button" data-toggle="collapse" href="#addUser<%=user.id%>ToUnion" aria-expanded="false" aria-controls="addUserToUnion"><span class="caret rotated"></span> Add to Unions</a>
    </div>

    <div id="addUser<%=user.id%>ToUnion" class="panel panel-collapse collapse" role="tabpanel" aria-labelledby="addUserToUnion">

      <div class="list-group">

      <!--new code -->
        <% @unions.each do |union| %>
          <div hidden="true">
            <%=union.id %>
          </div>
        
          <div class="list-group-item">
            <a role="button" id="<%=union.name.tr!(' ','-')%>" data-union-name="<%=union.name%>" data-union-id="<%=union.id%>" data-toggle="collapse" href="#user-<%=user.id%>-union-<%=union.name%>" data-role-ids="[]" data-eligibility-id="" aria-expanded="false">
              <%=union.name%>
            </a>
          </div>
        <% end %>
      </div>
    </div>
































<!--Old Code -->
            <!-- <div id="<%=union.name.downcase%>Status" data-union-id="<%=union.id%>">
              <% if user.eligibilities.find_by(union_id: union.id) && user.eligibilities.where(union_id: union.id).where.not(permit_days: nil).first %>             
                  <input type="checkbox" id="<%=union.name.downcase%>_permit" data-name="permit" value="" checked/>
                  <label for="<%=union.name.downcase%>_permit"> Permit </label>
                  <span id="<%=union.name.downcase%>_number_days"> * Number of Days:
                    <div contenteditable="true" id="<%=union.name.downcase%>_permit_days"><%= user.eligibilities.where(union_id: union.id).where.not(permit_days: nil).first.permit_days %></div>
                  </span>
              <% else %>
                <input type="checkbox" id="<%=union.name.downcase%>_permit" data-name="permit" value="" />
                <label for="<%=union.name.downcase%>_permit"> Permit </label>
                <span hidden="true" id="<%=union.name.downcase%>_number_days"> * Number of Days:
                  <div contenteditable="true" hidden="true" id="<%=union.name.downcase%>_permit_days"></div>
                </span>
              <% end %> 

              <% if user.eligibilities.find_by(member: true, union_id: union.id) %>

                <input type="checkbox" id="<%=union.name.downcase%>_member" data-name="member" value="true" checked/> 
              <% else %>              
                <input type="checkbox" id="<%=union.name.downcase%>_member" data-name="member" value="true" />
              <% end %>

              <label for="<%=union.name.downcase%>_member"> Member </label>
              

              <br>
            </div>

          <%end%>

            <div id="<%=union.name.downcase%>_roles">
              <%union.roles.distinct.each do |role|%>
               <% if user.eligibilities.find_by(role_id: role.id, union_id: union.id) %> 
                  <label for="<%=role.name%>">
                    <input 
                      type="checkbox" 
                      class="roles" 
                      id="<%=role.name%>" 
                      name="<%=role.name%>" 
                      data-user-id="<%=user.id%>"
                      data-union-id="<%=union.id%>"
                      data-label-id="" 
                      data-rolez-id="<%=role.id%>" 
                      data-eligibility-id="<%= user.eligibilities.find_by(role_id: role.id, union_id: union.id).id %>" 
                      value="<%=role.name%>" 
                      checked/> 
                    <span class="label-text">
                    <%=role.name%>
                    </span>
                  </label>
                <% else %>
                    <label for="<%=role.name%>">
                      <input 
                      type="checkbox" 
                      class="roles" 
                      id="<%=role.name%>" 
                      name="<%=role.name%>" 
                      data-user-id="<%=user.id%>"
                      data-union-id="<%=union.id%>"
                      data-rolez-id="<%=role.id%>" 
                      data-eligibility-id="" 
                      value="<%=role.name%>"/>
                      <span class="label-text">
                      <%=role.name%> 
                      </span>
                    </label>
                <%end%>

              <%end%>
            </div>


          </div>
          <%end%> -->
    

<!--add certificates-->

  <!-- <div class="field">
    <a role="button" data-toggle="collapse" href="#addUser<%=user.id%>Certificates" aria-expanded="false" aria-controls="addUserCertificates"><span class="caret rotated"></span> Add Certificates</a>
  </div>

  <div id="addUser<%=user.id%>Certificates" class="panel panel-collapse collapse" role="tabpanel" aria-labelledby="addUserCertificates">

    <div class="field user-info" data-user-id="<%=user.id %>">
      <h5> Add certificates: </h5>
        <% @certificates.each do |certificate| %>
          <label>            
            <div hidden="true"><%=certificate.id%>
            </div>
            <% if user.certificates.include? certificate %>
                
              <% if user.certifiables.find_by(certificate_id: certificate.id, user_id: user.id) %>
                <input 
                  type="checkbox" 
                  class="edit-certificates" 
                  id="<%=user.id%>-<%=certificate.id%>" 
                  name="<%=user.id%>-<%=certificate.id%>" 
                  value="<%=certificate.name%>" 
                  data-certifiable-id="<%= user.certifiables.find_by(certificate_id: certificate.id, user_id: user.id).id %>" 
                  data-label-id="" 
                  data-eligibility-id="" 
                  checked/>
                  <%=certificate.name%>
              <% end %>

            <%else%>

              <input 
                type="checkbox" 
                class="edit-certificates" 
                id="<%=user.id%>-<%=certificate.id%>" 
                name="<%=user.id%>-<%=certificate.id%>" 
                value="<%=certificate.name%>" 
                data-certifiable-id="" 
                data-label-id="" 
                data-eligibility-id=""/>
                <%=certificate.name%>

            <%end%>
          </label>

        <%end%>
    </div>
  </div> -->

     

  <!-- <div class="field user-info">
    <button class="delete-user btn" data-user-id="<%=user.id %>">Delete</button>
  </div> -->
<!-- </div>  -->
 