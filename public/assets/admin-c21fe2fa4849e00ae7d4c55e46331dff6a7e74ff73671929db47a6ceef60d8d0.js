function updateSponsorNameImage(e,t,i,a){var n=$(a).prev().prev();if(""==e||""==t)return $(n).text("Name or Website can't be blank").show().delay(3e3).fadeOut(1e3),$(a).show(),$(a).next().hide(),!1;$.ajax({url:"/sponsors/"+i,method:"put",data:{sponsor:{id:i,name:e,website_url:t}},success:function(){$(a).show(),$(a).next().hide(),$(n).prev().show(),setTimeout(function(){location.reload(!0)},2e3)}})}$(function(){function e(e,t){var i,a=$(e).closest(".union-info").data("union-id");"has_member"==$(e).data("name")&&(i={union:{id:a,has_member_status:t}}),"has_permit"==$(e).data("name")&&(i={union:{id:a,has_permit_status:t}}),$.ajax({url:"/admin/unions/"+a,method:"put",dataType:"json",data:i,success:function(){}})}$(".union-name").on("blur",function(){var e=$(this),t=e.closest(".union-info").data("union-id");if(""==t)var i="admin/unions",a="post";else var i="admin/unions/"+t,a="put";var n=e.closest(".union-name").text().trim();if(""==n)return e.addClass("invalid").next().show(),!1;$(".union-name-error").hide(),e.addClass("valid"),$.ajax({url:i,method:a,dataType:"json",data:{union:{name:n}},success:function(t){if(t.id)e.closest(".union-info").data("union-id",t.id).next(".union-info").data("union-id",t.id).next(".union-info").children("#save-new-union").data("union-id",t.id),e.closest(".union-info").next(".union-info").next(".union-info").next(".union-info").children(".cancel-button").data("union-id",t.id),$("#newUnion").data("name",t.name),$("#new-union-roles").show();else{var i=t.toString();$(".union-name-error").text("*"+i).show(),$(".union-name").addClass("invalid")}}})}),$("#has_member, #has_permit, #edit_has_member, #edit_has_permit").on("click",function(){if($(this).is(":checked")){var t=$(this).val();e($(this),t)}else{var t="false";e($(this),t)}}),$(".edit-roles").on("click",function(){var e=$(this),t=e.closest(".union-info").data("union-id"),i=e.prev().text(),a=e.data("eligibility-id");e.is(":checked")?$.ajax({url:"/admin/eligibilities",method:"post",dataType:"json",data:{eligibility:{union_id:t,role_id:i}},success:function(t){if(t.id)$(e).data("eligibility-id",t.id);else{var i=t.toString();$(".union-name-error").text("*"+i).show()}}}):$.ajax({url:"/admin/eligibilities/"+a,method:"delete",dataType:"json",data:{eligibility_id:a},success:function(){}})}),$(".delete-union, .cancel-button").on("click",function(){var e=$(this).data("union-id"),t=$(this).closest(".in").data("name");$.ajax({url:"/admin/unions/"+e,method:"delete",success:function(e){e.result&&($("#delete-union-success").show(),$("#edit"+t).remove(),$("#button"+t).remove(),$("#editUnionToggle").children(".caret").toggleClass("rotated"),$("#newUnion .union-name").text(""),$("#newUnion .union-info").data("union-id",""),$("#newUnion .edit-roles").prop("checked",!1),$("#newUnion").removeClass("in"),setTimeout(function(){$("#delete-union-success").fadeOut()},3e3))}})}),$("#save-new-union").on("click",function(){$("#newUnion").removeClass("in"),$("#create-success").show(),setTimeout(function(){location.reload(!0)},2e3)}),$(".role-name").on("blur",function(){var e=$(this),t=e.closest(".role-info").data("role-id");if(""==t)var i="admin/roles",a="post";else var i="admin/roles/"+t,a="put";var n=e.closest(".role-name").text().trim();if(""==n)return e.addClass("invalid").next().show(),!1;$(".role-name-error").hide(),e.addClass("valid"),$.ajax({url:i,method:a,dataType:"json",data:{role:{name:n}},success:function(t){if(t.id)e.closest(".role-info").data("role-id",t.id).next(".role-info").data("role-id",t.id).next(".role-info").children(".delete-role").data("role-id",t.id),$("#newrole").data("name",t.name),$("#new-role-roles").show();else{var i=t.toString();$(".role-name-error").text("*"+i).show(),$(".role-name").addClass("invalid")}}})}),$(".edit-unions").on("click",function(){var e=$(this),t=e.closest(".role-info").data("role-id"),i=e.prev().text(),a=e.data("eligibility-id");e.is(":checked")?$.ajax({url:"/admin/eligibilities",method:"post",dataType:"json",data:{eligibility:{role_id:t,union_id:i}},success:function(t){if(t.id)e.data("eligibility-id",t.id);else{var i=t.toString();$(".role-name-error").text("*"+i).show()}}}):$.ajax({url:"/admin/eligibilities/"+a,method:"delete",dataType:"json",data:{eligibility_id:a},success:function(){}})}),$(".delete-role").on("click",function(){var e=$(this).data("role-id");$.ajax({url:"/admin/roles/"+e,method:"delete",success:function(t){t.result&&($("#delete-role-success").show(),$("#edit-role-"+e).remove(),$("#button-role-"+e).remove(),$("#editRoleToggle").children(".caret").toggleClass("rotated"),$("#newRole .role-name").text(""),$("#newRole .role-info").data("role-id",""),$("#newRole .edit-roles").prop("checked",!1),$("#newRole").removeClass("in"),setTimeout(function(){$("#delete-role-success").fadeOut()},3e3))}})}),$("#save-new-role").on("click",function(){$("#newRole").removeClass("in"),$("#create-success").show(),setTimeout(function(){location.reload(!0)},2e3)}),$(".certificate-name").on("blur",function(){var e=$(this),t=e.closest(".certificate-info").data("certificate-id");if(""==t)var i="admin/certificates",a="post";else var i="admin/certificates/"+t,a="put";var n=e.closest(".certificate-name").text().trim();if(""==n)return e.addClass("invalid").next().show(),!1;$(".certificate-name-error").hide(),e.addClass("valid"),$.ajax({url:i,method:a,dataType:"json",data:{certificate:{name:n}},success:function(t){if(t.id)e.closest(".certificate-info").data("certificate-id",t.id).next(".certificate-info").data("certificate-id",t.id).next(".certificate-info").children(".delete-certificate").data("certificate-id",t.id),$("#newCertificate").data("name",t.name),$("#new-certificate-users").show();else{var i=t.toString();$(".certificate-name-error").text("*"+i).show(),$(".certificate-name").addClass("invalid")}}})}),$(".edit-users").on("click",function(){var e=$(this),t=e.closest(".certificate-info").data("certificate-id"),i=e.prev().text(),a=e.data("certifiable-id");e.is(":checked")?$.ajax({url:"/admin/certifiables",method:"post",dataType:"json",data:{certifiable:{certificate_id:t,user_id:i}},success:function(t){if(t.id)e.data("certifiable-id",t.id);else{var i=t.toString();$(".certificate-name-error").text("*"+i).show()}}}):$.ajax({url:"/admin/certifiables/"+a,method:"delete",dataType:"json",data:{certifiable_id:a},success:function(){}})}),$(".delete-certificate").on("click",function(){var e=$(this).data("certificate-id");$.ajax({url:"/admin/certificates/"+e,method:"delete",success:function(t){t.result&&($("#delete-certificate-success").show(),$("#edit-cert-"+e).remove(),$("#button-cert-"+e).remove(),$("#editCertificateToggle").children(".caret").toggleClass("rotated"),$("#newCertificate .certificate-name").text(""),$("#newCertificate .certificate-info").data("certificate-id",""),$("#newCertificate .edit-users").prop("checked",!1),$("#newCertificate").removeClass("in"),setTimeout(function(){$("#delete-certificate-success").fadeOut()},3e3))}})}),$("#save-new-certificate").on("click",function(){$("#newCertificate").removeClass("in"),$("#create-success").show(),setTimeout(function(){location.reload(!0)},2e3)}),$(".user-name").on("blur",function(){var e=$(this).closest(".user-info").data("user-id");if(""==e)var t="admin/users",i="post";else var t="admin/users/"+e,i="put";var a=$(this).closest(".user-name").text().trim();if(""==a)return $(this).addClass("invalid").next().show(),!1;$(".user-name-error").hide(),$(this).addClass("valid"),$.ajax({url:t,method:i,dataType:"json",data:{user:{name:a}},success:function(e){if(e.id)$(".user-info").data("user-id",e.id);else{var t=e.toString();$(".user-name-error").text("*"+t).show(),$(".user-name").addClass("invalid")}}})}),$(".edit-certificates").on("click",function(){var e=$(this).closest(".user-info").data("user-id"),t=$(this).prev().text(),i=$(this).data("certifiable-id"),a=$(this);$(this).is(":checked")?$.ajax({url:"/admin/certifiables",method:"post",dataType:"json",data:{certifiable:{certificate_id:t,user_id:e}},success:function(e){if(e.id)$(a).data("certifiable-id",e.id);else{var t=e.toString();$(".certificate-name-error").text("*"+t).show()}}}):$.ajax({url:"/admin/certifiables/"+i,method:"delete",dataType:"json",data:{certifiable_id:i},success:function(){}})}),$(".delete-user").on("click",function(e){$(this).hide(),$(this).next().show(),e.preventDefault();var t=$(this).data("user-id");$(this).data("user-name");$.ajax({url:"/admin/users/"+t,method:"delete",success:function(e){1==e.result&&($("#delete-user-success").show(),setTimeout(function(){$("#delete-user-success").fadeOut(),location.reload()},3e3))}})}),$("h3.panel-title").on("click",function(){$(this).children("a").children(".caret").toggleClass("rotated")}),$(".field").on("click",function(){$(this).children("a").children(".caret").toggleClass("rotated")}),$("#admin_job_management").DataTable({responsive:!0,dom:'<"top"f>rt<"bottom"lip><"clear">',columnDefs:[{orderable:!1,targets:[2]}]});$("#admin_edit_user").DataTable({responsive:!0,dom:'<"top"f>rt<"bottom"lip><"clear">',columnDefs:[{orderable:!1,targets:[1,2]}]});$("#add_sponsor").on("click",function(e){$("#add_sponsor").hide(),$("#submit_sponsor").show(),e.preventDefault();var t=$("#sponsor_name").val().trim(),i=$("#sponsor_webiste").val().trim();if(""==t)return alert("Name can't be blank"),$("#add_sponsor").show(),$("#submit_sponsor").hide(),!1;if(""==i)return alert("Sponsor Website can't be blank"),$("#add_sponsor").show(),$("#submit_sponsor").hide(),!1;if(""==t&&""==i)return alert("Sponsor Name and Website can't be blank"),$("#add_sponsor").show(),$("#submit_sponsor").hide(),!1;var a=new FormData;$input=$("#upload_sponsor_picture"),a.append("sponsor[picture]",$input[0].files[0]),$.ajax({url:"/sponsors",method:"post",data:a,cache:!1,contentType:!1,processData:!1,success:function(e){if(e.id>0){var a=e.id;$.ajax({url:"/sponsors/"+a,method:"put",data:{sponsor:{website_url:i,id:a,name:t}},success:function(e){e.id>0&&($("#add-sponsor-success").show(),setTimeout(function(){location.reload(!0)},2e3))}})}else alert(e),$("#submit_sponsor").hide(),$("#add_sponsor").show()}})}),$(".delete_sponsor").on("click",function(e){if(e.preventDefault(),$(this).hide(),"Yes"!=prompt("Are you Sure to delete this sponsor?(Yes/No)"))return $(this).show(),!1;var t=$(this).data("sponsorid");$(this).next().show();$(this);$.ajax({url:"/sponsors/"+t,method:"delete",data:{sponsor:{id:t}},complete:function(){$(".delete-sponsor-success").show(),setTimeout(function(){location.reload(!0)},2e3)}})}),$(".update_existing_sponsor").on("click",function(e){e.preventDefault(),$(this).hide(),$(this).next().show();var t=$(this).prev().find("#update_sponsor_name").val().trim(),i=$(this).prev().find("#update_sponsor_webiste").val().trim(),a=$(this).data("sponsorid");if(0==$(this).prev().find("#update_sponsor_picture").val().trim().length)updateSponsorNameImage(t,i,a,$(this));else{var n=new FormData;$input=$(this).prev().find("#update_sponsor_picture"),n.append("sponsor[picture]",$input[0].files[0]),n.append("sponsor[id]",a);var s=$(this);$.ajax({url:"/sponsors/"+a,method:"put",data:n,cache:!1,contentType:!1,processData:!1,success:function(e){updateSponsorNameImage(t,i,e.id,s)}})}}),$("#admin_sponsors_management").DataTable({responsive:!0,dom:'<"top"f>rt<"bottom"lip><"clear">',columnDefs:[{orderable:!1,targets:[1,2,3,4]}]})});